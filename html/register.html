<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宝贝网注册</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="styleSheet" href="../css/public.css">
    <link rel="styleSheet" href="../css/loginstyle.css">
    <link rel="styleSheet" href="../css/verify.css">
    <script src="../js/jquery-1.12.4.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/verify.js"></script>
</head>

<body>
    <div class="login_top">
        <div class="container">
            <div class="login_top_box">
                <a href="../index.html" class="login_top_box_img">
                    <img src="../imgs/logo1.png" alt="">
                </a>
            </div>

        </div>
        <div class="login_top_title  visible-md visible-lg">
            <i class="icon-tips"></i>
            <p>依《网络安全法》相关要求，即日起蘑菇街会员登陆需绑定手机。为保障您的账户安全及正常使用，如您尚未绑定，请尽快完成绑定，感谢您的理解和支持!</p>
        </div>
    </div>
    <!-- 登录内容 -->
    <div class="login_content">
        <div class="container">
            <div class="login_content_box register_content_box">
                <!-- 警告 -->
                <div class="login_content_top">
                    <i class="icon-tips"></i>
                    <p>宝贝网不会以任何理由要求您转账汇款，谨防诈骗。</p>
                </div>
                <!-- 登录框 -->
                <div class="login_content_center">
                    <div class="login_content_center_title">
                        <h3>注册</h3>
                    </div>
                    <div class="login_content_center_box">
                        <div>
                            <div class="login_content_center_input">
                                <label class="login_content_center_icon">
                                    <img src="../imgs/loginIcon4.png">
                                </label>
                                <input class="name" type="text" placeholder="请输入用户名">
                            </div>
                            <span class="colour_ash">8到20位（字母开头，数字，下划线，中文）</span>
                        </div>
                        <div>
                            <div class="login_content_center_input">
                                <label class="login_content_center_icon">
                                    <img src="../imgs/loginIcon6.png">
                                </label>
                                <input class="phone" type="text" placeholder="请输入手机号">
                            </div>
                            <span class="colour_ash">11位数字</span>
                        </div>
                        <div>
                            <div class="login_content_center_input">
                                <label class="login_content_center_icon">
                                    <img src="../imgs/loginIcon7.png">
                                </label>
                                <input class="email" type="text" placeholder="请输入邮箱">
                            </div>
                            <span class="colour_ash">6～18个字符(字母、数字、下划线)，需以字母开头</span>
                        </div>
                        <div>
                            <div class="login_content_center_input">
                                <label class="login_content_center_icon">
                                    <img src="../imgs/loginIcon5.png">
                                </label>
                                <input class="password" type="password" placeholder="请输入密码">
                            </div>
                            <span class="colour_ash">至少8个字符，至少1个大写字母，小写字母和数字</span>
                        </div>
                        <div>
                            <div class="login_content_center_input">
                                <label class="login_content_center_icon">
                                    <img src="../imgs/loginIcon5.png">
                                </label>
                                <input class="password1" type="password" placeholder="请再次输入密码">
                            </div>
                            <span class="colour_ash"></span>
                        </div>
                        <!-- 验证 -->
                        <div>
                            <div class="login_content_center_input">
                                <div id="mpanel1" class="">
                                </div>
                            </div>
                        </div>
                        <button class="login_content_center_btn" id="btn">
                            注册
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 底部 -->
    <div class="login_foot visible-md visible-lg">
        <div class="login_foot_box">
            <!-- 底部导航 -->
            <div class="login_foot_nav">
                <a href="#">关于我们</a><span>|</span>
                <a href="#">联系我们</a><span>|</span>
                <a href="#">人才招聘</a><span>|</span>
                <a href="#">商家入驻</a><span>|</span>
                <a href="#">广告服务</a><span>|</span>
                <a href="#">手机APP</a><span>|</span>
                <a href="#">友情链接</a><span>|</span>
                <a href="#">销售联盟</a><span>|</span>
                <a href="#">宝贝社区</a><span>|</span>
                <a href="#">规则中心</a><span>|</span>
                <a href="#">用户隐私保护</a>
            </div>
            <!-- 版权备案 -->
            <div class="login_foot_copyright">
                <p>© 2003-现在 Bodynet.com 版权所有</p>
                <br>
                <p>京公网安备 11000002000088号|京ICP证070359号</p>

            </div>
        </div>
    </div>
    <script>
        $(function () {
            var password1 = $(".password1");
            var stateName = false;
            var statePhone = false;
            var stateEmail = false;
            var statePassword = false;
            var statePassword1 = false;
            var stateVerify = false;

            function regular(el, reg) {
                var str = false;
                var newColor = el.parent();
                var newClass = el.parent().next();
                newClass.removeClass();
                if (reg.test(el.val())) {
                    newColor.css({
                        "border-color": "green",
                        "box-shadow": "0 0 18px green"
                    });
                    newClass.addClass("colour_green");
                    newClass.html("格式正确");
                    str = true;
                } else {
                    newColor.css({
                        "border-color": "red",
                        "box-shadow": "0 0 18px red"
                    });
                    newClass.addClass("colour_red");
                    newClass.html("格式错误，请重新输入");
                    str = false;
                }
                return str;
            }
            //用户名正则
            var regName = /^[A-Za-z\u4e00-\u9fa5][A-Za-z0-9_\-\u4e00-\u9fa5]{7,19}/;
            $(".name").blur(function () {
                stateName = regular($(".name"), regName);
            });
            //手机号正则
            var regPhone = /^1[3456789]\d{9}$/;
            $(".phone").blur(function () {
                statePhone = regular($(".phone"), regPhone);
            });
            //邮箱正则
            var regEmail = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/;
            $(".email").blur(function () {
                stateEmail = regular($(".email"), regEmail);
            });
            //密码正则
            var regPassword = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;
            $(".password").blur(function () {
                statePassword = regular($(".password"), regPassword);
                if ($(".password").val() == password1.val() && $(".password").val() != "") {
                    password1.parent().css({
                        "border-color": "green",
                        "box-shadow": "0 0 18px green"
                    });
                    password1.parent().next().addClass("colour_green");
                    password1.parent().next().html("格式正确");
                    statePassword1 = true;
                } else {
                    password1.parent().css({
                        "border-color": "red",
                        "box-shadow": "0 0 18px red"
                    });
                    password1.parent().next().addClass("colour_red");
                    password1.parent().next().html("两次输入不一致");
                    statePassword1 = false;
                }
            });
            //两次密码判断
            password1.blur(function () {
                var newColor = $(this).parent();
                var newClass = $(this).parent().next();
                newClass.removeClass();
                if ($(".password").val() == password1.val() && $(".password").val() != "") {
                    newColor.css({
                        "border-color": "green",
                        "box-shadow": "0 0 18px green"
                    });
                    newClass.addClass("colour_green");
                    newClass.html("格式正确");
                    statePassword1 = true;
                } else {
                    newColor.css({
                        "border-color": "red",
                        "box-shadow": "0 0 18px red"
                    });
                    newClass.addClass("colour_red");
                    newClass.html("两次输入不一致");
                    statePassword1 = false;
                }
            });

            //滑动验证
            $('#mpanel1').slideVerify({
                type: 1, //类型
                vOffset: 5, //误差量，根据需求自行调整
                barSize: {
                    width: '101%',
                    height: '38px',
                },
                ready: function () {},
                success: function () {
                    stateVerify = true;
                    //......后续操作
                },
                error: function () {
                    stateVerify = false;
                    //		        	alert('验证失败！');
                }

            });
            //点击事件
            $("#btn").click(function () {
                if (stateVerify) {
                    if (stateName && statePhone && stateEmail && statePassword && statePassword1) {
                        $.post("http://192.168.1.102:3000/users/register", {
                            username: $(".name").val(),
                            password: $(".password").val(),
                            phone: $(".phone").val(),
                            email: $(".email").val()
                        }, function (data) {
                            if (data.state == 0) {
                                alert($(".name").val()+"注册成功");
                                setTimeout(function () {
                                    location.href = "./login.html";
                                },1000);
                            } else if (data.state == 1) {
                                alert("用户名已存在");
                            }
                        });
                    } else {
                        alert("请输入正确的信息");
                    }
                } else {
                    alert("请滑动滑块");
                }
            });
        })
    </script>
</body>


</html>